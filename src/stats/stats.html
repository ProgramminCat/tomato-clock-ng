<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Stats - Tomato Clock</title>

    <link
      rel="icon"
      type="image/png"
      href="/assets/images/tomato-favicon.ico"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css"
      rel="stylesheet"
    />
  </head>

  <body>
    <div class="container">
      <h1 class="mt-3">Stats - Tomato Clock</h1>

      <hr />

      <div class="form-group">
        <label for="date-range-picker">Date Range</label>
        <input
          class="form-control"
          id="date-range-picker"
          type="text"
          name="daterange"
        />
      </div>

      <br />

      <div class="row">
        <div class="col-md-9">
          <div>
            <canvas id="completed-tomato-dates-chart"></canvas>
          </div>
        </div>
        <div class="col-md-3">
          <table class="table">
            <thead>
              <tr>
                <th>Timer</th>
                <th>#</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Tomatoes</td>
                <td id="tomatoes-count"></td>
              </tr>
              <tr>
                <td>Short Breaks</td>
                <td id="short-breaks-count"></td>
              </tr>
              <tr>
                <td>Long Breaks</td>
                <td id="long-breaks-count"></td>
              </tr>
              <tr>
                <td>Total Tomato Minutes</td>
                <td id="total-tomato-minutes"></td>
              </tr>
              <tr>
                <td>Average Tomato Minutes/Day</td>
                <td id="average-tomato-minutes-day"></td>
              </tr>
              <tr>
                <td>Average Tomato Minutes/Week</td>
                <td id="average-tomato-minutes-week"></td>
              </tr>
              <tr>
                <td>Average Tomato Minutes/Month</td>
                <td id="average-tomato-minutes-month"></td>
              </tr>
              <tr>
                <td>Longest Streak</td>
                <td id="longest-streak-count"></td>
              </tr>
              <tr>
                <td>Current Streak</td>
                <td id="current-streak-count"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <hr />

      <div class="row">
        <div class="col-md-12">
          <h2 class="mt-4">Best Time of Day Analysis</h2>
          <div id="time-of-day-section">
            <p class="text-muted">
              Discover when you're most productive throughout the day.
            </p>
            <div id="most-productive-time"></div>
            <div id="time-of-day-chart-container">
              <canvas id="time-of-day-chart"></canvas>
            </div>
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Time of Day</th>
                  <th>Tomatoes</th>
                  <th>Total Minutes</th>
                  <th>Avg Minutes/Session</th>
                </tr>
              </thead>
              <tbody id="time-of-day-stats-body">
                <!-- Time of day stats will be populated here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <hr />

      <div class="row">
        <div class="col-md-12">
          <h2 class="mt-4">Stats by Task</h2>
          <div id="task-stats-section">
            <p class="text-muted">
              View tomato completion statistics grouped by task.
            </p>
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Task Name</th>
                  <th>Tomatoes</th>
                  <th>Total Minutes</th>
                  <th>% of Total</th>
                </tr>
              </thead>
              <tbody id="task-stats-body">
                <!-- Task stats will be populated here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <hr />

      <div class="row">
        <div class="col-md-12">
          <h2 class="mt-4">Recent Sessions with Notes</h2>
          <div id="session-history-section">
            <p class="text-muted">
              View your recent tomato sessions and the notes you added.
            </p>
            <div
              class="form-group"
              style="max-width: 200px; margin-bottom: 15px"
            >
              <label for="session-history-limit">Show last:</label>
              <select id="session-history-limit" class="form-control">
                <option value="10">10 sessions</option>
                <option value="25" selected>25 sessions</option>
                <option value="50">50 sessions</option>
                <option value="100">100 sessions</option>
              </select>
            </div>
            <div id="session-history-list">
              <!-- Session history will be populated here -->
            </div>
          </div>
        </div>
      </div>

      <hr />
      <div style="width: 40%">
        <h2 class="mt-4">Calendar</h2>
        <div id="stats-calendar"></div>
      </div>
      <hr />

      <hr />

      <button class="btn btn-primary" id="export-stats-button">
        Export Stats as JSON
      </button>
      <a id="downloadAnchorElem" style="display: none"></a>

      <button class="btn btn-secondary" id="import-stats-button">
        Import Stats from JSON
      </button>
      <input
        hidden
        type="file"
        accept="application/json"
        id="import-stats-hidden-input"
      />

      <button class="btn btn-info" id="import-legacy-stats-button">
        Import Stats from Legacy JSON Format
      </button>

      <button class="btn btn-warning" id="reset-stats-button">
        Reset Stats
      </button>
    </div>
  </body>
</html>
